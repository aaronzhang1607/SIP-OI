# 注射泵控制软件
## Stereotactic Injection Pump Operational Interface (SIP-OI)
这是一个基于Shiny的注射泵控制软件，专为WPI micro2T设备设计，提供直观的图形界面来控制注射泵的各项功能。

## 功能特点

- 自动检测可用的COM端口
- 支持双泵控制（泵1和泵2）
- 可调节的注射参数：
  - 目标体积（nL）
  - 输送速率（nL/sec或nL/min，最大1000 nL/min）
  - 注射/吸取模式切换
- 间歇注射模式：
  - 可设置注射时间和间隔时间
  - 自动循环执行
- 退针功能：
  - 一键快速回退针头
  - 固定回退速度1000 nL/min
  - 自动5秒后停止
  - 操作确认提示
- 实时通信状态显示
- 通信历史记录
- 支持中文界面

## 系统要求

- Windows 操作系统
- R (>= 4.0.0)
- RStudio (推荐)
- 以下R包：
  - shiny
  - serial

## 安装依赖

在R中运行以下命令安装所需包：

```r
install.packages(c("shiny", "serial"))
```

## 使用方法

1. 连接设备：
   - 使用USB线连接WPI micro2T设备
   - 启动应用程序
   - 在"串口设置"中选择正确的COM端口
   - 点击"连接串口"按钮

2. 设置泵参数：
   - 选择要控制的泵号（1或2）
   - 设置单位（nL/sec或nL/min）
   - 输入目标体积（nL）
   - 设置输送速率（最大1000 nL/min）

3. 基本控制：
   - 点击"注射"或"吸取"设置流动方向
   - 使用"开始/继续"、"暂停"、"停止"控制泵的运行

4. 间歇注射模式：
   - 在"间歇注射模式"部分设置注射时间和间隔时间
   - 点击"开始间歇注射"启动循环注射

5. 使用退针功能：
   - 点击右侧的"退针操作"面板
   - 阅读警告信息并确认操作安全
   - 点击"执行退针"按钮
   - 针头将以1000 nL/min的速度回退
   - 5秒后自动停止

6. 监控状态：
   - 在"通信"标签页查看实时通信状态
   - 在"历史记录"标签页查看详细的操作历史
   - 在"关于"标签页查看软件信息和使用说明

## 注意事项

- 使用前请确保已正确安装设备驱动
- 确保没有其他程序正在使用目标COM端口
- 错误的参数设置可能导致设备异常，请谨慎操作
- 退针操作会以1000 nL/min的固定速度回退针头，持续5秒后自动停止
- 执行退针前请确保操作环境安全
- 最大输送速率限制为1000 nL/min，这是设备的安全上限
- 如果连接失败，请检查：
  - 设备是否已正确连接
  - 设备电源是否开启
  - COM端口是否被其他程序占用
  - 设备驱动是否已正确安装

## 许可证

GNU General Public License v3.0
